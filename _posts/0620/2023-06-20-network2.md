---
title: "네트워크 7-1 멀티미디어 네트워크"

categories:
  - Network
tags:
  - Network
---

> 이 글은 KOCW에서 제공하는 한양대학교 이석복 교수님의 컴퓨터 네트워크 강의를 기반으로 내용을 정리하고 복습하기 위한 용도로 작성되었습니다.

## 멀티미디어 네트워크

- 유튜브와 같이 서버로부터 받는 데이터가 멀티미디어인 경우 멀티미디어 네트워킹이라 지칭한다.

#### 1. Audio

---

- 음성이나 음악같은 아날로그 신호를 데이터로 변환한 음성파일은 계속해서 변화하는 일종의 진동이다.
- 이러한 아날로그 신호를 디지털 파일로 저장하고 전송하기 위해선
  인코딩이라는 작업이 필요하다.
- 인코딩은 아날로그 신호의 변화폭을 특정 시간축 기준으로 쪼개서 디지털 신호로 기록하는것을 뜻한다.
- 이러한 인코딩 과정에서 기준으로 삼을 시간축을 작은 단위로 샘플링을 할수록 디지털 신호로 변환했을때 데이터의 계단은 많아지고 이는 더욱 선명한 음질로 들을 수 있다는것을 의미한다.
- 사람 음성으로 예를 들면 초당 8000번의 샘플링이 필요하고 이는 64000bps의 용량이 필요함을 뜻한다.
- 이러한 bps값이 높을수록 음질이 좋아진다.

#### 2. Video

---

- 비디오는 이미지의 연속이다.
- 비디오 역시 프레임 단위로 이미지를 저정하는 방식의 인코딩을 할 수 있는데 한 프레임에 속하는 이미지는 픽셀 단위로 저장된다.
- 이때 이미지같은경우 한 픽셀과 주위 픽셀이 같은경우가 많다. 이러한 경우 주변의 픽셀이 같은값을 가진다는 식으로 저장하여 용량을 줄일수 있다.
- 한 프레임의 연속된 다음 프레임 또한 같은 픽셀값을 가지는 경우가 많은데 이도 마찬가지로 코딩하여 데이터의 용량을 줄일 수 있다.

## multimedia networking service: 3 application types

1. Streaming stored audio/ video: 전체 파일을 다운로드 하기 전에 재생할 수 있는 서비스
2. Conversational voice/ video over IP: 스카이프, 카카오톡같은 영상/음성 통화
3. Streaming live audio/ video: 즉석에서 영상을 인코딩하여 중계하는 서비스

#### 1. streaming stored audio / video

---

![9-1](https://github.com/mjh851819/mjh851819.github.io/assets/70308520/08462c42-13ce-487d-9a83-8b21f65659d8)

- 서버가 멀티미디어를 서버에 저장해 두었다가 사용자에게 전송하고 사용자는 이 데이터를 받음과 동시에 재생함으로써 전체 파일을 받기전에 영상을 시청할 수 있다.
- 하지만 현실에서는 네트워크 딜레이가 일정하지(Jitter 라고 부른다) 않아서 클라이언트가 다음 프레임을 재생해야할 타이밍에 데이터가 전송되지 않아 영상이 끊기는 현상이 발생한다.
- 이는 클라이언트가 데이터를 전송받는 즉시 미디어를 재생하기 때문에 예측할 수 없는 딜레에 의해서 영상이 끊기는것이다.
- 따라서 클라이언트는 위 그래프처럼 play out delay를 두고 일정 시간 후에 영상을 재생함으로써 네트워크 딜레이를 숨길 수 있다.
- 이해하기 쉽게 설명하면 일정량을 영상 데이터 버퍼에 쌓아둔 후에 영상을 재생하는것이다.
- 우리가 자주 시청하는 유튜브의 타임라인바에서 이러한 현상을 쉽게 관측하고 이해할 수 있을것이다.
  > 그렇다면 유튜브는 어떻게 이런 멀티미디어 네트워킹을 버퍼링없이 클라이언트에게 제공할 수 있는것일까?

#### 2. 스트리밍 서비스와 TCP, UDP

---

- 스트리밍 서비스는 TCP와 UDP중 어떤 프로토콜을 사용할까?
- 상식적으로 알고있는 TCP와 UDP의 특징을 기반으로 UDP를 사용해야 할 것이라고 생각할 것이다.
- 스트리밍 서비스를 클라이언트에게 원활하게 전달하기 위해선 최소로 보장되어야하는 전송속도가 있다.
- TCP의 전송속도는 리시버의 상황이나 네트워크의 상황에따라 전송속도가 결정되기 때문에 sender측에서 전송속도를 결정할 수 있는 udp를 떠올리는것은 당연하다.
- 하지만 네트워크 상황이 현재 1bps밖에 안되는데 udp를 사용해서 데이터를 보내봤자 클라이언트는 영상을 제대로 받지 못하고 대부분이 로스되는 상황이 벌어질 것이다.

- 따라서 애플리케이션 계층에서 이를 해결할 방법을 모색해야한다.
- 유튜브와같은 성공적 스트리밍 서비스는 이를 어떻게 해결했을까?

#### 3. DASH ( Dynamic Adaptive Streaming over HTTP): 동적으로 적응하는 HTTP기반 스트리밍

---

- 우선 서버측에서는 멀티미디어를 인코딩 하기 전 수많은 청크로 쪼갠다.
- 이러한 청크를 인코딩할때 인코딩하는 비트 레이트를 전부 다르게하여 다양한 옵션으로 인코딩된 멀티미디어를 가지고 있는다.
  > 다양한 화질로 인코딩 해 둔다는 것을 의미한다. 인코딩된 영상의 크기가 작을수록 보장해야하는 전송속도의 최솟값이 줄어들기 때문이다.
- 서버는 이러한 다양한 옵션으로 인코딩된 청크의 url을 클라이언트에게 제공한다.
- 위 방법으로 클라이언트는 네트워크 상황에따라서 적당한 크기로 인코딩된 멀티미디어를 받는다.
- 이러한 멀티미디어의 인코딩 비트레이트는 네트워크 상황에따라서 동적으로 결정된다.
- 따라서 우리는 네트워크상황이 안좋으면 화질이 나빠질지 언정 영상이 중간에 사라지는 현상은 겪지 않을 수 있다.

#### 4. Content Distribution Network (CDN)

---

> 문제: 멀티미디어 네트워킹은 엄청나게 큰 용량의 데이터를 제공한다. 스트리밍 서비스는 전 세계에서 엄청난 숫자의 사람들이 이러한 큰 용량의 데이터를 요청하는데 어떻게 정상적으로 서비스가 운영될 수 있을까?

- content distribution network(CDN)
- 멀티미디어의 복사본을을 저장하고 제공하는 서버(CDN server)를 지역적으로 운영하여 사용자와 가까운 CDN 서버가 데이터를 제공한다.
- 스트리밍 사이트는 클라이언트의 요청에 따라 컨텐츠를 인덱싱하고 실제 미디어를 제공하는것은 사용자 근처에 있는 CDN 서버인 것이다.
- 구체적인 과정은 다음과 같다.

1. 철수가 유튜브에 영상A를 요청하는 메세지를 브라우저를 통해서 보내려한다.
2. DNS서버에서 유튜브의 ip주소를 알기위한 요청을 먼저 보낸다.
3. 이때 유튜브는 영상을 관리하는 CDN서버의 DNS서버를 알려준다.
4. 우리는 CDN서버의 DNS서버에서 우리와 지리적으로 가장 가까운 CDN서버의 ip주소를 받는다.
